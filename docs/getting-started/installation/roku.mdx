---
title: Roku
slug: roku
excerpt: Instructions for installing RevenueCat's Roku SDK
hidden: false
---

:::warning Beta Feature
RevenueCat's Roku support is currently in beta. For interest, please fill out our [waitlist form](https://rev.cat/roku-beta-interest).
:::

## Introduction
RevenueCat's Roku support allows you to easily offer subscriptions on Roku's streaming platform. This feature is currently in beta and has a number of known limitations. The following RevenueCat features and functionalities are not supported yet.

RevenueCat features not yet supported:
- [RevenueCat paywalls](/tools/paywalls)
- [Trusted entitlements](/customers/trusted-entitlements)
- [Offline entitlements](/customers/customer-info#offline-entitlements)
- [Offerings metadata](/tools/offering-metadata)
- [Targeting](/tools/targeting)
- [Placements](/tools/targeting/placements)

Functionality not yet supported:
- OTPs (one-time purchases)
- Consumable purchases
- Detecting price changes
- Chargebacks
- Purchase transfers
- Extending subscriptions
- Identifying customers upon configuration

If your use case is not supported above, reach out to [RevenueCat Support](https://app.revenuecat.com/settings/support) so we can discuss more on how to support you!

## General setup
### Prerequisites 
#### Setting up your Roku developer account
Follow the [First Steps](https://developer.roku.com/en-gb/docs/developer-program/getting-started/first-steps.md) guide to create a Roku developer account, login to your Roku device and enable developer mode on your Roku device.

#### Setting up your Roku channel
Once you have your developer account created, head to the [dashboard](https://developer.roku.com/dev/dashboard)

1. First, [create a new Channel](https://developer.roku.com/en-gb/docs/developer-program/publishing/channel-publishing-guide.md#create-a-channel)
2. If you want to use this channel for testing, make sure the channel is [enabled for billing testing](https://developer.roku.com/en-gb/docs/developer-program/roku-pay/testing/billing-testing.md)
3. Under "Monetization" -> "Test users", [add a test user](https://developer.roku.com/en-gb/docs/developer-program/roku-pay/quickstart/test-users.md) with the email associated to your Roku device
4. Under "Monetization" -> "Product", follow the process to submit the tax documents, and after you're approved, you can [create in-channel products](/getting-started/entitlements/roku-products)

### App configuration
1. Make sure your project has been enabled to create Roku apps. If you're not sure, talk to your RevenueCat contact.
2. Open the RevenueCat dashboard, select your project, and click on "Add app" > "Roku Store"
![](/images/roku/add-roku-app.png)

![](/images/roku/roku-app.png)

3. Enter your app's name. Navigate to the [Roku Pay Web Services page](https://developer.roku.com/rpay-web-service) to copy your the Roku Pay API key and paste this to the RevenueCat dashboard under 'Roku Pay API Key'
![](/images/roku/roku-api-key.png)

![](/images/roku/roku-name-key.png)

4. Find your Roku Channel ID in your Roku Developer Dashboard and enter this value in the RevenueCat dashboard under 'Roku Channel ID'
![](/images/roku/roku-channel-id.png)

![](/images/roku/roku-multi-channel.png)

<figure>
[](/images/roku/roku-multi-channel.png)
<figcaption>Remember to select 'SAVE CHANGES'</figcaption>
</figure>

5. Once the app is created, click on the "Roku Server to Server notifications settings", copy the "Roku Push Notification URL" which starts with `https://api.revenuecat.com/v1/incoming-webhooks/roku-pay-jwt-notification`. Navigate back to your [Roku Pay Web Services page](https://developer.roku.com/rpay-web-service) (where you found the Roku API key) page and scroll down until you see a section called 'Push Notifications' and paste RevenueCat's Push notifications URL in the text box
![](/images/roku/roku-notification-url.png)

<figure>
![](/images/roku/roku-notifications.png)
<figcaption>Remember to select 'SAVE CHANGES'</figcaption>
</figure>

6. Back to the RevenueCat dashboard, click on "Public API Key" and copy over the value which should start with "roku_XXXXXX". You will need it to configure the SDK later.
![](/images/roku/revenuecat-api-key.png)


### Product configuration
After you have configured the Roku Store app on RevenueCat, you should [create your in-channel products](/getting-started/entitlements/roku-products) and then follow RevenueCat's regular setup of [entitlements, products, and offerings](/getting-started/entitlements).


## Installing the SDK
1. Clone the repository:

import rokuClone from "!!raw-loader!@site/code_blocks/getting-started/installation/configuring-roku_1.shell";

<RCCodeBlock tabs={[
    { type: 'shell', content: rokuClone, name: 'Terminal' }
]} />

2. Copy the `components/purchases` folder into your app's `components` folder.
3. Copy the `source/Purchases.brs` file into your app's `source` folder.
4. Import the SDK in the .xml file of the component where you want to use it:

import rokuXML from "!!raw-loader!@site/code_blocks/getting-started/installation/roku-import-sdk.xml";

<RCCodeBlock tabs={[
    { type: 'xml', content: rokuXML, name: 'XML' }
]} />

## Configuring the SDK
**Important:** The SDK should be used only from SceneGraph components. Calling it from the main thread or from a Task component is not supported.

Initialize the SDK with your api key. You typically do this inside the `init()` method of your main scene.

import rokuConfigure from "!!raw-loader!@site/code_blocks/getting-started/installation/configuring-roku_2.brs";

<RCCodeBlock tabs={[
    { type: 'brightscript', content: rokuConfigure, name: 'Brightscript' }
]} />

## Callbacks and error handling
In methods of the SDK which perform async operations, you can get the result by passing a sub routine or a callback name.

- The first parameter will contain the result.
- The second parameter will contain an error if there was one, or `invalid` if there wasnt.

**Example:**

import rokuCallbacksErrorHandling from "!!raw-loader!@site/code_blocks/getting-started/installation/roku-callbacks-error-handling.brs";

<RCCodeBlock tabs={[
    { type: 'brightscript', content: rokuCallbacksErrorHandling, name: 'Brightscript' }
]} />

## Models 

### Subscriber 

import rokuSubscriber from "!!raw-loader!@site/code_blocks/getting-started/installation/roku-subscriber.brs";
import rokuLoginLogout from "!!raw-loader!@site/code_blocks/getting-started/installation/roku-login-logout.brs";
import rokuSubscriberInfo from "!!raw-loader!@site/code_blocks/getting-started/installation/roku-subscriber-info.brs";
import rokuSubscriberAttributes from "!!raw-loader!@site/code_blocks/getting-started/installation/roku-subscriber-attributes.brs";

<RCCodeBlock tabs={[
    { type: 'brightscript', content: rokuSubscriber, name: 'Subscriber Object' },
    { type: 'brightscript', content: rokuLoginLogout, name: 'logIn / logOut' },
    { type: 'brightscript', content: rokuSubscriberInfo, name: 'Subscriber Info' },
    { type: 'brightscript', content: rokuSubscriberAttributes, name: 'Subscriber Attributes' }
]} />


### Offerings 
import rokuGetOfferings from "!!raw-loader!@site/code_blocks/getting-started/installation/roku-get-offerings.brs";
import rokuOffersObject from "!!raw-loader!@site/code_blocks/getting-started/installation/roku-offerings-object.txt";

<RCCodeBlock tabs={[
    { type: 'brightscript', content: rokuOffersObject, name: 'Offerings object' },
    { type: 'brightscript', content: rokuGetOfferings, name: 'Get Offerings' }
]} />

### Purchase
#### Making a purchase
As a parameter to the `purchase()` method, you can pass an associative array containing one of the following values:

- `code`: A string containing the product id.
- `product`: From the `getOfferings` result: e.g. `offerings.current.annual.storeProduct`
- `package`: From the `getOfferings` result: e.g. `offerings.current.annual`

Additionally,you can pass the following optional parameters:

- `action`: To perform a product change. Valid values: `Upgrade` or `Downgrade`

#### Sync purchase
This method will post all purchases associated with the current Roku account to RevenueCat and become associated with the current User ID. It should only be used if you're migrating from using your own Roku Pay implementation and want to track previous purchases in RevenueCat.

import rokuPurchaseObject from "!!raw-loader!@site/code_blocks/getting-started/installation/roku-purchase-object.txt";
import rokuMakePurchase from "!!raw-loader!@site/code_blocks/getting-started/installation/roku-make-purchase.brs";
import rokuSyncPurchases from "!!raw-loader!@site/code_blocks/getting-started/installation/roku-sync-purchases.brs";


<RCCodeBlock tabs={[
    { type: 'brightscript', content: rokuPurchaseObject, name: 'Raw transaction' },
    { type: 'brightscript', content: rokuMakePurchase, name: 'Make purchase' },
    { type: 'brightscript', content: rokuSyncPurchases, name: 'Sync purchase' }
]} />

### Error
The error model constains two fields: `code` and `message`

import rokuError from "!!raw-loader!@site/code_blocks/getting-started/installation/roku-error.txt";

<RCCodeBlock tabs={[
    { type: 'brightscript', content: rokuError, name: 'Error' }
]} />

### Tying everything together
For most apps, the usage of the SDK would look like this:

1. Initialise the SDK
2. Log in the user
4. Check if the entitlement is active
5. Fetch offerings and show your paywall UI
6. Make a purchase

import rokuTyingTogether from "!!raw-loader!@site/code_blocks/getting-started/installation/roku-tying-together.brs";

<RCCodeBlock tabs={[
    { type: 'brightscript', content: rokuTyingTogether}
]} />


## Testing
:::warning
Only the "root account user" can test billing on device. If you get added as a collaborator to someone else's developer account, billing testing will not work. You'll need to create your own developer account.
:::

Roku allows you to test with either their **Public channels** or **Beta channels**. However, you can only use one public or beta channel at a time for testing. 

We recommend that you create a separate channel for testing purposes and creating a new [RevenueCat Roku Store app](/getting-started/installation/roku#app-configuration) for that channel.

### Testing with beta channel

Roku's beta channels are a special channel type to assist with testing your channel in a production-like environment before publishing. 

#### Beta channel rules
- **120 days**: A beta channel can exist for only 120 days after you create it. After 120 days, the channel will be (1) deleted and removed from your Developer Dashboard and (2) disabled for all users who have it installed
- **10 channels**: There is a maximum of 10 beta channels at a time
- **20 test users**: There can only be 20 beta test users per beta channel at any given time

#### Create a beta channel
To create a beta channel, select "Beta channels" in your Roku Developer Dashboard, then refer to the ["Setting up your Roku channel"](/getting-started/installation/roku#setting-up-your-roku-channel) section for additional instructions.

### Testing with public channel

#### Create a public channel
To create a public channel, select "Public channels" in your Roku Developer Dashboard, then refer to the ["Setting up your Roku channel"](/getting-started/installation/roku#setting-up-your-roku-channel) section for additional instructions.
