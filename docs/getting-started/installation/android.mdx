---
title: Android
slug: android
excerpt: Instructions for installing Purchases SDK for Android
hidden: false
---

## What is RevenueCat?

RevenueCat provides a backend and a wrapper around StoreKit and Google Play Billing to make implementing in-app purchases and subscriptions easy. With our SDK, you can build and manage your app business on any platform without having to maintain IAP infrastructure. You can read more about [how RevenueCat fits into your app](https://www.revenuecat.com/blog/growth/where-does-revenuecat-fit-in-your-app/) or you can [sign up free](https://app.revenuecat.com/signup) to start building.

## Android

### Installation

Purchases for Android (Google Play and Amazon Appstore) is available on Maven and can be included via Gradle.

You can find the latest version below, and for more details, visit the [Releases page](https://github.com/RevenueCat/purchases-android/releases).

[![Release](https://img.shields.io/github/v/release/RevenueCat/purchases-android.svg?&style=flat)](https://github.com/RevenueCat/purchases-android/releases)

import buildGradle1 from "@site/code_blocks/getting-started/installation/android_4.kts?raw";
import buildGradle2 from "@site/code_blocks/getting-started/installation/android_1.groovy?raw";

<RCCodeBlock
  tabs={[
    { type: "kotlin", content: buildGradle1, name: "Kotlin" },
    { type: "groovy", content: buildGradle2, name: "Groovy" },
  ]}
/>

### Import Purchases

You should now be able to import `Purchases`.

import kotlinContent from "@site/code_blocks/getting-started/installation/android_5.kt?raw";
import javaContent from "@site/code_blocks/getting-started/installation/android_2.java?raw";

<RCCodeBlock
  tabs={[
    { type: "kotlin", content: kotlinContent, name: "Kotlin" },
    { type: "java", content: javaContent, name: "Java" },
  ]}
/>

### Configure Proguard (Optional)

We are adding Proguard rules to the library so you don't need to do anything. If you have any issues finding classes in our SDK, try adding `-keep class com.revenuecat.purchases.** { *; }` to your Proguard configuration.

:::warning
Purchases uses AndroidX App Startup under the hood. Make sure you have not removed the `androidx.startup.InitializationProvider` completely in your manifest. If you need to remove specific initializers, such as `androidx.work.WorkManagerInitializer`, set `tools:node="merge"` on the provider, and `tools:node="remove"` on the meta-data of the initializer you want to remove.

import xmlContent from "@site/code_blocks/getting-started/installation/android_workmanager_manifest.xml?raw";

<RCCodeBlock
  tabs={[{ type: "xml", content: xmlContent, name: "AndroidManifest.xml" }]}
/>
:::

### Enhanced Restores with Billing Client 8 (Optional)

:::warning
We highly recommend developers that do NOT have an account system and that use or have used One time products to configure this correctly.
:::

Starting on Billing Client 8, Google removed the ability to query consumed one time purchases through Google's Billing Client library. This means that our SDK won't be able to restore these purchases.

This can be problematic if both:
- Your app DOESN'T offer an account system (so users can't log in to recover their purchases) and you rely on RevenueCat's anonymous users AND
- Your app has or had at any point in time, one time products configured as consumables in the RevenueCat dashboard that you would like to be able to restore. In this case, RevenueCat would have consumed those purchases, making them not available to find them through the Billing Client.

In this scenario, these users will have anonymous user ids that won't be easily recoverable and won't be able to recover their purchases through the Billing Client, potentially increasing support requests.

One way to reduce the impact of this issue is by making sure RevenueCat's data is safely backed up in the user's Google account, so it is automatically restored when the user reinstalls the app and/or changes devices. RevenueCat stores data in its own SharedPreferences file. The exact name of that file is available as the constant `RevenueCatBackupAgent.REVENUECAT_PREFS_FILE_NAME`, which you can reference when setting up backups. We recommend you also include your app's default SharedPreferences file. 

There are 2 recommended approaches Google offers to perform backups:
- [Auto Backup](https://developer.android.com/identity/data/autobackup)
- [Key-value backups](https://developer.android.com/identity/data/keyvaluebackup). 

#### Auto Backup
Auto Backup is enabled by default in your app. This backs up most of your app content, including the RevenueCat SharedPreferences files up to a 25MB limit, at which point, it stops doing backups. You can configure what you want to backup following [the official documentation](https://developer.android.com/identity/data/autobackup#IncludingFiles).

We recommend adjusting the files you want to back up to make sure you don't go over the limit and making sure the RevenueCat SharedPreferences file is included.

#### Key-Value backups
Please note that enabling this will disable Auto backup and will just back up RevenueCat files!

If you prefer to disable auto-backup and just back up the RevenueCat SharedPreferences file, you may optionally use our provided `RevenueCatBackupAgent` to perform a backup of the relevant files. To do this, you need to add to your app's `AndroidManifest.xml` `<application>` node a property like this:

```xml
android:backupAgent="com.revenuecat.purchases.backup.RevenueCatBackupAgent"
```

#### What should you do?
For the majority of apps, Auto Backup is enabled by default and should handle backups for you without doing anything. However, there are some situations where it won't:
- If your app has the potential of having more than 25MB of data over the files that Auto Backup automatically backs up (See [docs](https://developer.android.com/identity/data/autobackup#Files))
- If you have modified the files you would like to backup using Auto Backup and have not included RevenueCat's SharedPreferences file.
- If you have disabled backups

If you are in one of those positions, we recommend you make sure your backup configuration includes the RevenueCat SharedPreferences file without going over the 25MB limit, or, in case you have backups disabled, you may enable auto backup only for this file or just add the `RevenueCatBackupAgent` to your AndroidManifest.xml application, as mentioned above.

#### How to test backups
Whether you're using Auto Backup or Key-Value backups, Google provides some documentation on how to test backups and restores [in their documentation](https://developer.android.com/identity/data/testingbackup).

One thing to note, however, is that these backups are not guaranteed to work across all devices and might require factory resets in the target device to use the backup.

### Set the correct launchMode

Depending on your user's payment method, they may be asked by Google Play to verify their purchase in their (banking) app. This means they will have to background your app and go to another app to verify the purchase. If your Activity's `launchMode` is set to anything other than `standard` or `singleTop`, backgrounding your app can cause the purchase to get cancelled. To avoid this, set the `launchMode` of your Activity to `standard` or `singleTop` in your `AndroidManifest.xml` file, like so:

import launchModeContent from "@site/code_blocks/getting-started/installation/android_launchmode.xml?raw";

<RCCodeBlock
  tabs={[
    { type: "xml", content: launchModeContent, name: "AndroidManifest.xml" },
  ]}
/>

You can find Android's documentation on the various `launchMode` options [here](https://developer.android.com/guide/topics/manifest/activity-element#lmode).

## Amazon

### Additional Dependencies

Add a new dependency to the `build.gradle` apart from the regular `purchases` dependency. These new dependencies have the classes needed to use Amazon IAP:

You can find the latest version below, and for more details, visit the [Releases page](https://github.com/RevenueCat/purchases-android/releases).

[![Release](https://img.shields.io/github/v/release/RevenueCat/purchases-android.svg?&style=flat)](https://github.com/RevenueCat/purchases-android/releases)

import amazonGradle1 from "@site/code_blocks/getting-started/installation/android_6.kts?raw";
import amazonGradle2 from "@site/code_blocks/getting-started/installation/android_3.groovy?raw";

<RCCodeBlock
  tabs={[
    { type: "kotlin", content: amazonGradle1, name: "Kotlin" },
    { type: "groovy", content: amazonGradle2, name: "Groovy" },
  ]}
/>

### Add Amazon public key

Adding support for Amazon requires adding a `.pem` public key to your project. You can configure this key by following Amazon's guide [here](https://developer.amazon.com/es/docs/in-app-purchasing/integrate-appstore-sdk.html#configure_key).

Due to some limitations, RevenueCat will only validate purchases made in production or in Live App Testing and won't validate purchases made with the Amazon App Tester.

## Next Steps

- Now that you've installed the Purchases SDK in your Android app, get started by [configuring an instance of Purchases ](/getting-started/quickstart#4-using-revenuecats-purchases-sdk)
