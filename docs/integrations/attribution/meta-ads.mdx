---
title: Meta Ads
slug: meta-ads
excerpt: Integrate Purchases SDK with Meta Ads for precise revenue tracking
hidden: false
---

With our Meta Ads (formerly Facebook Ads) integration you can:

- Accurately track subscriptions generated from Meta Ad campaigns, allowing you to know precisely how much revenue your campaigns generate.
- Send trial starts, trial conversions, and renewals directly from RevenueCat to Meta Ads Manager, allowing for accurate tracking without an app open.
- Continue to follow your cohorts for months to know the long tail revenue generated by your campaigns.

### Integration at a Glance

| Includes Revenue | Supports Negative Revenue |               Sends Sandbox Events               | Includes Customer Attributes | Sends Transfer Events | Optional Event Types |
| :--------------: | :-----------------------: | :----------------------------------------------: | :--------------------------: | :-------------------: | :------------------: |
|        ✅        |            ❌             | Requires sandbox Client Token and sandbox App ID |              ❌              |          ❌           |          ❌          |

## 1. Install Meta SDK

Before RevenueCat can integrate with Meta, your app must be running the Meta SDK. Refer to the [Meta developer documentation](https://developers.facebook.com/docs/) for the latest installation instructions.

## 2. Send device data to RevenueCat

The following attributes are used by RevenueCat's Meta integration:

| Key            | Description                                                                                                                                     | Platform |
| :------------- | :---------------------------------------------------------------------------------------------------------------------------------------------- | :------- |
| `$idfa`        | iOS [advertising identifier](https://developer.apple.com/documentation/adsupport/asidentifiermanager/1614151-advertisingidentifier) UUID        | iOS      |
| `$gpsAdId`     | Google [advertising identifier](https://developers.google.com/android/reference/com/google/android/gms/ads/identifier/AdvertisingIdClient.Info) | Android  |
| `$fbAnonId`    | Facebook anonymous identifier                                                                                                                   | iOS      |
| `$idfv`        | iOS [vendor identifier](https://developer.apple.com/documentation/uikit/uidevice/1620059-identifierforvendor) UUID                              | iOS      |
| `$ip`          | The IP address of the device                                                                                                                    | Any      |
| `$email`       | The email address of the user                                                                                                                   | Any      |
| `$phoneNumber` | The phone number of the user                                                                                                                    | Any      |

### Required attributes for event delivery

For an event to be successfully dispatched to Meta, the associated customer must have specific attributes set at the time the event is processed. These requirements differ based on which Meta API you're using and which platform an event originates from.

:::info Placeholder values not accepted
If `$idfa` or `$gpsAdId` are used for this integration, their values must not be empty or zeroed values
:::

#### App Events API

| Platform   | Required Attributes                                                                                              |
| :--------- | :--------------------------------------------------------------------------------------------------------------- |
| App Store  | ✅ <code>$fbAnonId</code> or <code>$idfa</code><br/>✅ <code>$attConsentStatus</code> == <code>authorized</code> |
| Play Store | ✅ <code>$fbAnonId</code> or <code>$gpsAdId</code>                                                               |

#### Conversions API

| Platform   | Required Attributes                                                                                                                                                                                                |
| :--------- | :----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| App Store  | ✅ <code>$fbAnonId</code> or <code>$idfa</code><br/>✅ <code>$attConsentStatus</code> == <code>authorized</code> (or the dashboard setting <code>Send events when ATT consent is not authorized</code> is enabled) |
| Play Store | ✅ <code>$fbAnonId</code> or <code>$gpsAdId</code>                                                                                                                                                                 |

:::warning Android ID deprecation
Due to policy changes from the Play Store, Android ID is no longer collected by RevenueCat's Android SDKs starting on versions 6.9.8+, 7.11.1+, and later major versions.

Therefore, Google's Advertising ID acts as the primary device identifier for Android devices in RevenueCat and when connecting with third-party integrations.
:::

:::danger Device identifiers with iOS App Tracking Transparency (iOS 14.5+)
If you are requesting the App Tracking permission through ATT to access the IDFA, you can call `.collectDeviceIdentifiers()` _again_ if the customer accepts the permission to update the `$idfa` attribute in RevenueCat.
:::

### Setting device attributes

These properties can be set manually, like any other [Attribute](/customers/customer-attributes), or through the helper methods to `collectDeviceIdentifiers()` and `setFbAnonymousId()`.

import swiftContent from "@site/code_blocks/integrations/attribution/facebook-ads_1.swift?raw";
import flutterContent from "@site/code_blocks/integrations/attribution/facebook-ads_2.js.txt?raw";
import kotlinContent from "@site/code_blocks/integrations/attribution/facebook-ads_3.kt?raw";
import reactNativeContent from "@site/code_blocks/integrations/attribution/facebook-ads_4.js.txt?raw";

<RCCodeBlock
  tabs={[
    { type: "swift", content: swiftContent },
    { type: "flutter", content: flutterContent },
    { type: "kotlin", content: kotlinContent },
    { type: "rn", content: reactNativeContent },
  ]}
/>

You should make sure to set attributes after the _Purchases SDK_ is configured, and before the first purchase occurs. It's safe to set this multiple times, as only the new/updated values will be sent to RevenueCat.

:::info Import AdSupport Framework (iOS)
The AdSupport framework is required to access the IDFA parameter on iOS. Don't forget to import this into your project.
:::

![Import AdSupport Framework](/docs_images/integrations/attribution/import-adsupport-framework.png)

:::danger Remove Meta SDK Purchase Tracking
Make sure to remove all client side tracking of revenue. Since RevenueCat will be sending events for all revenue actions, tracking purchases with the Meta SDK directly can lead to double counting of revenue in Meta Ads Manager.

You can disable automatic In-App Purchase event logging from the Meta SDK or from your Meta app dashboard. Go to the iOS/Android card under Settings > Platform > Log In-App Events Automatically > No

To continue to track install and usage events in Meta, follow the steps in the next section.
:::

### Track Install and Usage Events

As noted above, you'll need to disable all client side tracking of revenue to prevent double counting of revenue in Meta Ads Manager. To continue tracking install and usage events, you'll need to call Meta's 'activate app' event after configuration:

import swiftContent2 from "@site/code_blocks/integrations/attribution/facebook-ads_5.swift?raw";
import kotlinContent2 from "@site/code_blocks/integrations/attribution/facebook-ads_5.kt?raw";
import reactNativeContent2 from "@site/code_blocks/integrations/attribution/facebook-ads_5.js.txt?raw";
import flutterContent2 from "@site/code_blocks/integrations/attribution/facebook-ads_5.dart?raw";

<RCCodeBlock
  tabs={[
    { type: "swift", content: swiftContent2 },
    { type: "kotlin", content: kotlinContent2 },
    { type: "rn", content: reactNativeContent2 },
    { type: "flutter", content: flutterContent2 },
  ]}
/>

You can see Meta's App Events Reference [here](https://developers.facebook.com/docs/app-events/reference).

## 3. Send RevenueCat events into Meta Ads Manager

After you've set up the _Purchases SDK_ to send attribution data to RevenueCat, you can turn on the integration from the RevenueCat dashboard.

1. Navigate to your project settings in the RevenueCat dashboard and choose 'Meta Ads' from the Integrations menu

![Integration setup](/docs_images/integrations/setup-integrations.png)

### Integrating with the Conversions API

We recommend integrating with the Conversions API for better reliability and long-term support. If you choose to setup a Conversions API integration, you can follow the steps below:

1. Select the **Conversions API** integration type.
2. Add your Datasource ID for production events (and optionally an Datasource ID for sandbox events). You can find this ID in the Events Manager, selecting which datasource you'd like to use.
3. Add the Client Token for your app (and for the sandbox Datasource if included). You can find your Client Token in the Events Manager dashboard, under your selected **Datasource > Settings > Generate Access Token**.
4. Modify the option to `Send events when ATT consent is not authorized` if desired. [Learn more](https://developers.facebook.com/docs/marketing-api/conversions-api/parameters/app-data).
5. (Optional) You can toggle between different names for Meta events. The default values are set based on what the most natural equivalent Meta event is for the RevenueCat event being configure, as defined below.
6. Select whether you want sales reported as gross revenue (before app store commission), or after store commission and/or estimated taxes.

### Integrating with the App Events API

If you choose to integrate with the App Events API, you can follow the steps below:

1. Select the **App Events API** integration type.
2. Add your Meta App ID for production events (and optionally an App ID for sandbox events).
3. Add the Meta Client Token for your app (and for the sandbox App ID if included). You can find your Client Token in the Meta dashboard under your **App > Settings > Advanced > Client Token**. You may need to click the 'Reset' button if there's no Client Token visible.
4. (Optional) You can toggle between different names for Meta events. The default values are set based on what the most natural equivalent Meta event is for the RevenueCat event being configured, as defined below.
5. Select whether you want sales reported as gross revenue (before app store commission), or after store commission and/or estimated taxes.

### Event Names

RevenueCat allows you to choose from different 'Standard' Meta event names. Using 'Standard' events is recommended by Meta for optimizing advertising campaigns and audiences.

| RevenueCat Event      | Recommended Meta Event |
| :-------------------- | :--------------------- |
| Trial Started         | StartTrial             |
| Trial Converted       | Subscribe              |
| Initial Purchase      | Subscribe              |
| Renewal               | Subscribe              |
| Non-Renewing Purchase | Purchase               |

## 4. Testing the Meta Ads Manager integration

You can test the Meta integration end-to-end before going live. It's recommended that you test the integration is working properly for new users, and any existing users that may update their app to a new version.

### Add a sandbox App Id and sandbox Client token in the RevenueCat dashboard

Before you test the integration, make sure you have a Meta App Id and Client Token set in the "Sandbox" fields in RevenueCat. This is required if you want the integration to trigger for sandbox purchases.

### Make a sandbox purchase with a new user

Simulate a new user installing your app, and go through your app flow to complete a sandbox purchase.

### Check that the required device data is collected

Navigate the the [Customer Profile](/dashboard-and-metrics/customer-profile) for the test user that just made a purchase. Make sure that all of the required data from step 1 above is listed as attributes for the user.

![](/docs_images/integrations/attribution/meta/required-attributes.png)

### Check that the Meta event delivered successfully

While still on the Customer Profile, click into the test purchase event in the [Customer History](/dashboard-and-metrics/customer-profile#customer-history) and make sure that the Meta integration event exists and was delivered successfully.

![](/docs_images/integrations/attribution/meta/successful-event.png)

:::success
You have completed the Events API integration! You can stop here or continue with the rest of the documentation to learn how to set up the Conversions API.
:::

## 6. View Events in Meta

Once events are delivered to Meta, they can be used across Events Manager, Ads Manager, and Audiences.

:::info Meta event delay
Note that there could be up to a 24 hour delay from when events are sent to when they are shown in the Meta Events Manager dashboard.
:::

### Events Manager

The events sent from RevenueCat will appear throughout Meta Events Manager as 'Standard' event types. Any events sent with revenue attached will be counted toward the 'Revenue' number in Meta. This includes trial conversions and renewals that occur when the app isn't active.

![Revenue is sent directly into Meta Events Manager](/docs_images/integrations/attribution/meta/meta-events-manager.png)

### Advanced Matching

RevenueCat will send Customer information that you specify as Attributes to Meta. This information includes email, name, phone number, etc. Make sure the Automatic Advanced Matching toggle is turned on under your app settings.

![](/docs_images/integrations/attribution/meta/advanced-matching.png)

### Ads Manager

Within Meta Ads Manager, you can customize the display columns to include subscription specific metrics. The 'Subscriptions' and 'Trials Started' values will be updated by the 'Subscribe' and 'StartTrial' events sent by RevenueCat, respectively.

![](/docs_images/integrations/attribution/meta/ads-manager-subscriptions.png)

![](/docs_images/integrations/attribution/meta/ads-manager-trials-started.png)

By tracking the subscription revenue attributed to your Meta campaigns you can quickly spot your most effective campaigns.

### Audiences

Meta allows you to create custom audiences based off of events. This means you can create an audience of subscribers, and even create a "Lookalike" audience for better ad targeting.

To create a custom audience off of subscribers:

1. Create a Custom Audience and select 'App activity' as the source.

![](/docs_images/integrations/attribution/meta/create-custom-audience.png)

2. Choose an event, such as 'Subscribe' to create your audience off of.

![](/docs_images/integrations/attribution/meta/create-custom-audience-2.png)

:::success You've done it!
You should start seeing events from RevenueCat appear in Meta Ads Manager.
:::
